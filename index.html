<!DOCTYPE html><html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>자리 배치</title>
  <style>
    body { font-family: sans-serif; }
    .layout {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
      flex-wrap: wrap;
    }
    .section {
      display: grid;
      gap: 10px;
    }
    .cell {
      background: #f0f0f0;
      border: 1px solid #aaa;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      width: 60px;
      height: 60px;
    }
    .clicked {
      background: #ffcccc;
    }
    .board {
      width: 400px;
      margin: 0 auto;
      height: 40px;
      background: #d0d0d0;
      text-align: center;
      line-height: 40px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .inputs {
      text-align: center;
      margin-bottom: 10px;
    }
    .unplaced-box {
      max-width: 600px;
      margin: 20px auto;
      background: #ffeeee;
      border: 1px dashed #ff9999;
      padding: 10px;
      font-size: 16px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h2 style="text-align:center;">자리 배치</h2>
  <div class="board">(칠판)</div>  <div class="inputs">
    시작 번호: <input type="number" id="startNum" value="1" />
    끝 번호: <input type="number" id="endNum" value="28" />
    제외할 번호(쉼표로): <input type="text" id="excludeNums" placeholder="예: 3,5,12" />
    총 칸 수: <input type="number" id="totalCells" value="30" />
    <button onclick="generateSeats()">자리 생성</button>
  </div>  <div class="layout" id="seatLayout"></div>
  <div id="unplaced" class="unplaced-box" style="display:none;"></div>  <script>
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    let seatStates = [];

    function createCell(index, value) {
      const div = document.createElement("div");
      div.className = "cell";
      div.textContent = value;
      div.dataset.seatIndex = index;

      if (seatStates[index] === "X") {
        div.textContent = "";
        div.classList.add("clicked");
      }

      div.addEventListener("click", () => {
        const idx = parseInt(div.dataset.seatIndex);
        if (seatStates[idx] === "X") {
          seatStates[idx] = null;
          div.textContent = div.dataset.originalText;
          div.classList.remove("clicked");
        } else {
          seatStates[idx] = "X";
          div.dataset.originalText = div.textContent;
          div.textContent = "";
          div.classList.add("clicked");
        }
      });

      return div;
    }

    function generateSeats() {
      const start = parseInt(document.getElementById("startNum").value);
      const end = parseInt(document.getElementById("endNum").value);
      const totalCells = parseInt(document.getElementById("totalCells").value);
      const exclude = document.getElementById("excludeNums").value
        .split(",")
        .map(s => parseInt(s.trim()))
        .filter(n => !isNaN(n));

      if (start >= end || start < 1 || end < 1 || totalCells <= 0) {
        alert("입력 값을 확인해주세요.");
        return;
      }

      const seatLayout = document.getElementById("seatLayout");
      const unplacedBox = document.getElementById("unplaced");
      seatLayout.innerHTML = "";
      unplacedBox.style.display = "none";
      unplacedBox.innerHTML = "";

      let validNumbers = [];
      for (let i = start; i <= end; i++) {
        if (!exclude.includes(i)) validNumbers.push(i);
      }

      const neededX = Math.max(0, totalCells - validNumbers.length);
      for (let i = 0; i < neededX; i++) validNumbers.push("x");

      shuffle(validNumbers);

      seatStates = Array(totalCells).fill(null);
      const columns = 2;
      const sectionCount = 3;
      const rows = Math.ceil(totalCells / (columns * sectionCount));

      for (let s = 0; s < sectionCount; s++) {
        const section = document.createElement("div");
        section.className = "section";
        section.style.gridTemplateColumns = `repeat(${columns}, 60px)`;
        section.style.gridTemplateRows = `repeat(${rows}, 60px)`;

        for (let i = 0; i < columns * rows; i++) {
          const globalIndex = s * columns * rows + i;
          if (globalIndex >= validNumbers.length) break;
          const val = validNumbers[globalIndex];
          section.appendChild(createCell(globalIndex, val === "x" ? "" : val));
        }

        seatLayout.appendChild(section);
      }

      const used = sectionCount * columns * rows;
      const unplaced = validNumbers.slice(used).filter(v => v !== "x");
      if (unplaced.length > 0) {
        unplacedBox.style.display = "block";
        unplacedBox.textContent = "배치되지 못한 번호: " + unplaced.join(", ");
      }
    }
  </script></body>
</html>
